"use strict";(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[1604,5146],{1604:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("ele-toolbar",{attrs:{theme:"none"},scopedSlots:e._u([{key:"action",fn:function(){return[t("div",{class:["ele-file-tool-search",{"hidden-xs-only":e.styleResponsive}]},[t("el-input",{attrs:{size:"small",placeholder:"搜索您的文件"},scopedSlots:e._u([{key:"append",fn:function(){return[t("el-button",{attrs:{icon:"el-icon-search"}})]},proxy:!0}]),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e.grid?t("i",{staticClass:"ele-file-tool-btn el-icon-_menu",on:{click:e.toggleShowType}}):t("i",{staticClass:"ele-file-tool-btn el-icon-_nav",on:{click:e.toggleShowType}})]},proxy:!0}])},[t("el-upload",{staticClass:"ele-action ele-inline-block",attrs:{action:"","show-file-list":!1,"before-upload":e.onUpload}},[t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"small",type:"primary",icon:"el-icon-upload2"}},[e._v(" 上传 ")])],1),t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"small",icon:"el-icon-folder-add"},on:{click:e.openFolderAdd}},[e._v(" 新建文件夹 ")]),t("el-button",{staticClass:"ele-btn-icon hidden-xs-only",attrs:{size:"small",type:"danger",icon:"el-icon-delete",disabled:!e.checked.length},on:{click:e.removeBatch}},[e._v(" 删除 ")]),t("folder-add",{attrs:{visible:e.folderAddVisible,"parent-id":e.parentId},on:{"update:visible":function(t){e.folderAddVisible=t},done:e.onDone}})],1)},n=[],r=a(69590),o=a(37789),i=a(35146),l={components:{FolderAdd:i["default"]},props:{grid:Boolean,checked:Array,parentId:Number},data(){return{search:"",folderAddVisible:!1}},computed:{styleResponsive(){return this.$store.state.theme.styleResponsive}},methods:{onUpload(e){if(e.size/1024/1024>100)return this.$message.error("大小不能超过 100MB"),!1;const t=this.$messageLoading("上传中..");return(0,r.cT)(e).then((e=>{(0,o.b1)({name:e.name,isDirectory:0,parentId:this.parentId,path:e.path,length:e.length,contentType:e.contentType}).then((()=>{t.close(),this.$message.success("上传成功"),this.onDone()})).catch((e=>{t.close(),this.$message.error(e.message)}))})).catch((e=>{t.close(),this.$message.error(e.message)})),!1},openFolderAdd(){this.folderAddVisible=!0},removeBatch(){this.$confirm("确定要删除选中的文件吗?","提示",{type:"warning"}).then((()=>{const e=this.$messageLoading("请求中..");(0,o.Cp)(this.checked.map((e=>e.id))).then((t=>{e.close(),this.$message.success(t),this.onDone()})).catch((t=>{e.close(),this.$message.error(t.message)}))})).catch((()=>{}))},onDone(){this.$emit("done")},toggleShowType(){this.$emit("update:grid",!this.grid)}}},c=l,d=a(1001),u=(0,d.Z)(c,s,n,!1,null,"4e72c92e",null),m=u.exports},35146:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("ele-modal",{attrs:{width:"460px",visible:e.visible,"append-to-body":!0,"close-on-click-modal":!0,"custom-class":"ele-dialog-form",title:"新建文件夹"},on:{"update:visible":e.updateVisible},scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-button",{on:{click:function(t){return e.updateVisible(!1)}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v(" 保存 ")])]},proxy:!0}])},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"102px"}},[t("el-form-item",{attrs:{label:"文件夹名称:",prop:"name"}},[t("el-input",{attrs:{clearable:"",maxlength:20,placeholder:"请输入文件夹名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)},n=[],r=a(37789),o={props:{visible:Boolean,parentId:Number},data(){return{form:{name:""},rules:{name:[{required:!0,message:"请输入文件夹名称",trigger:"blur"}]},loading:!1}},methods:{save(){this.$refs.form.validate((e=>{if(!e)return!1;this.loading=!0,(0,r.b1)({...this.form,parentId:this.parentId,isDirectory:1}).then((e=>{this.loading=!1,this.$message.success(e),this.updateVisible(!1),this.$emit("done")})).catch((e=>{this.loading=!1,this.$message.error(e.message)}))}))},updateVisible(e){this.$emit("update:visible",e)}},watch:{visible(e){e||(this.$refs.form.clearValidate(),this.form.name="")}}},i=o,l=a(1001),c=(0,l.Z)(i,s,n,!1,null,null,null),d=c.exports},69590:function(e,t,a){a.d(t,{Yd:function(){return o},cG:function(){return i},cT:function(){return n},dk:function(){return r}});a(21703);var s=a(84471);async function n(e){const t=new FormData;t.append("file",e);const a=await s.Z.post("/file/upload",t);return 0===a.data.code?a.data.data:Promise.reject(new Error(a.data.message))}async function r(e){const t=await s.Z.get("/file/page",{params:e});return 0===t.data.code?t.data.data:Promise.reject(new Error(t.data.message))}async function o(e){const t=await s.Z["delete"]("/file/remove/"+e);return 0===t.data.code?t.data.message:Promise.reject(new Error(t.data.message))}async function i(e){const t=await s.Z["delete"]("/file/remove/batch",{data:e});return 0===t.data.code?t.data.message:Promise.reject(new Error(t.data.message))}},37789:function(e,t,a){a.d(t,{Cp:function(){return l},IX:function(){return i},JU:function(){return o},Ml:function(){return n},b1:function(){return r}});a(21703);var s=a(84471);async function n(e){const t=await s.Z.get("/system/user-file",{params:e});return 0===t.data.code&&t.data.data?t.data.data:Promise.reject(new Error(t.data.message))}async function r(e){const t=await s.Z.post("/system/user-file",e);return 0===t.data.code?t.data.message:Promise.reject(new Error(t.data.message))}async function o(e){const t=await s.Z.put("/system/user-file",e);return 0===t.data.code?t.data.message:Promise.reject(new Error(t.data.message))}async function i(e){const t=await s.Z["delete"]("/system/user-file/"+e);return 0===t.data.code?t.data.message:Promise.reject(new Error(t.data.message))}async function l(e){const t=await s.Z["delete"]("/system/user-file/batch",{data:e});return 0===t.data.code?t.data.message:Promise.reject(new Error(t.data.message))}}}]);