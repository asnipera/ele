(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[7557,1661,9431],{61661:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=function(){var e=this,t=e._self._c;return t("el-card",{attrs:{shadow:"never",header:"导出 Excel"}},[t("ele-pro-table",{attrs:{size:"mini",columns:e.columns,datasource:e.users,selection:e.select,toolkit:["size","columns","fullscreen"],"need-page":!1},on:{"update:selection":function(t){e.select=t}},scopedSlots:e._u([{key:"toolbar",fn:function(){return[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.exportBas}},[e._v(" 导出 ")]),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.exportAdv}},[e._v(" 导出带表头合并 ")]),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.exportSel}},[e._v(" 导出选中 ")])]},proxy:!0}])})],1)},n=[],s=(r(41539),r(54747),r(84105)),o={data:function(){return{columns:[{columnKey:"selection",type:"selection",width:45,align:"center"},{columnKey:"index",type:"index",width:45,align:"center"},{prop:"username",label:"用户名",align:"center",showOverflowTooltip:!0},{prop:"addressGroup",label:"地址",align:"center",showOverflowTooltip:!0,children:[{prop:"province",label:"省",align:"center",showOverflowTooltip:!0},{prop:"city",label:"市",align:"center",showOverflowTooltip:!0},{prop:"zone",label:"区",align:"center",showOverflowTooltip:!0},{prop:"street",label:"街道",align:"center",showOverflowTooltip:!0},{prop:"address",label:"详细地址",align:"center",showOverflowTooltip:!0}]},{prop:"amount",label:"金额",align:"center",showOverflowTooltip:!0}],users:[{key:1,username:"张小三",amount:18,province:"浙江",city:"杭州",zone:"西湖区",street:"西溪街道",address:"西溪花园30栋1单元"},{key:2,username:"李小四",amount:39,province:"江苏",city:"苏州",zone:"姑苏区",street:"丝绸路",address:"天墅之城9幢2单元"},{key:3,username:"王小五",amount:8,province:"江西",city:"南昌",zone:"青山湖区",street:"艾溪湖办事处",address:"中兴和园1幢3单元"},{key:4,username:"赵小六",amount:16,province:"福建",city:"泉州",zone:"丰泽区",street:"南洋街道",address:"南洋村6幢1单元"},{key:5,username:"孙小七",amount:12,province:"湖北",city:"武汉",zone:"武昌区",street:"武昌大道",address:"两湖花园16幢2单元"},{key:6,username:"周小八",amount:11,province:"安徽",city:"黄山",zone:"黄山区",street:"汤口镇",address:"温泉村21号"}],select:[]}},methods:{exportBas:function(){var e=[["用户名","省","市","区","街道","详细地址","金额"]];this.users.forEach((function(t){e.push([t.username,t.province,t.city,t.zone,t.street,t.address,t.amount])}));var t="Sheet1",r={SheetNames:[t],Sheets:{}},a=s.P6.aoa_to_sheet(e);r.Sheets[t]=a,a["!cols"]=[{wch:10},{wch:10},{wch:10},{wch:10},{wch:20},{wch:40},{wch:10}],(0,s.NC)(r,"用户数据.xlsx")},exportAdv:function(){var e=[["用户名","地址",null,null,null,null,"金额"],[null,"省","市","区","街道","详细地址",null]];this.users.forEach((function(t){e.push([t.username,t.province,t.city,t.zone,t.street,t.address,t.amount])}));var t=s.P6.aoa_to_sheet(e);t["!merges"]=[{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:0},e:{r:1,c:0}},{s:{r:0,c:6},e:{r:1,c:6}}];var r="Sheet1",a={SheetNames:[r],Sheets:{}};a.Sheets[r]=t,(0,s.NC)(a,"用户数据.xlsx")},exportSel:function(){if(0!==this.select.length){var e=[["用户名","省","市","区","街道","详细地址","金额"]];this.select.forEach((function(t){e.push([t.username,t.province,t.city,t.zone,t.street,t.address,t.amount])}));var t="Sheet1",r={SheetNames:[t],Sheets:{}};r.Sheets[t]=s.P6.aoa_to_sheet(e),(0,s.NC)(r,"用户数据.xlsx")}else this.$message.error("请至少选择一条数据")}}},l=o,i=r(1001),c=(0,i.Z)(l,a,n,!1,null,null,null),p=c.exports},59431:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});r(38862);var a=function(){var e=this,t=e._self._c;return t("el-card",{attrs:{shadow:"never",header:"导入 Excel"}},[t("div",{staticStyle:{display:"flex","margin-bottom":"12px"}},[t("el-upload",{staticClass:"ele-action",attrs:{action:"","show-file-list":!1,"before-upload":e.importFile,accept:".xls,.xlsx"}},[t("el-button",{staticClass:"hidden-xs-only",attrs:{type:"primary",size:"small"}},[e._v(" 导入 ")])],1),t("el-upload",{staticClass:"ele-action",attrs:{action:"","show-file-list":!1,"before-upload":e.importFile2,accept:".xls,.xlsx"}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("导入拆分合并")])],1),t("el-upload",{staticClass:"ele-action",attrs:{action:"","show-file-list":!1,"before-upload":e.importFile3,accept:".xls,.xlsx"}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("导入保持合并")])],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",border:!0,data:e.importData,"span-method":e.spanMethod}},[t("el-table-column",{attrs:{type:"index",width:"45",align:"center"}}),e._l(e.importTitle,(function(e,r){return t("el-table-column",{key:r,attrs:{prop:e,label:e,align:"center","show-overflow-tooltip":""}})}))],2),t("el-row",{attrs:{gutter:30}},[t("el-col",e._b({},"el-col",e.styleResponsive?{md:12}:{span:12},!1),[t("div",{staticStyle:{padding:"15px 0"}},[e._v("二维数组格式数据:")]),t("pre",{staticStyle:{"max-height":"300px",overflow:"auto"}},[e._v(e._s(JSON.stringify(e.importDataAoa,null,4)))])]),t("el-col",e._b({},"el-col",e.styleResponsive?{md:12}:{span:12},!1),[t("div",{staticStyle:{padding:"15px 0"}},[e._v("JSON格式数据:")]),t("pre",{staticStyle:{"max-height":"300px",overflow:"auto"}},[e._v(e._s(JSON.stringify(e.importData,null,4)))])])],1)],1)},n=[],s=(r(26699),r(39575),r(41539),r(82472),r(48675),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(37380),r(1118),r(54747),r(84105)),o={data:function(){return{importData:[],importTitle:["A","B","C","D","E","F","G"],importDataAoa:[]}},computed:{styleResponsive:function(){return this.$store.state.theme.styleResponsive}},methods:{importFile:function(e){var t=this;if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return this.$message.error("只能选择 excel 文件"),!1;if(e.size/1024/1024>20)return this.$message.error("大小不能超过 20MB"),!1;var r=new FileReader;return r.onload=function(e){var r=new Uint8Array(e.target.result),a=(0,s.ij)(r,{type:"array"}),n=a.SheetNames,o=a.Sheets[n[0]],l=s.P6.sheet_to_json(o,{header:1}),i=[],c=0,p=[];l.forEach((function(e){e.length>c&&(c=e.length);for(var r={},a=0;a<e.length;a++)r[t.getCharByIndex(a)]=e[a];i.push(r)}));for(var u=0;u<c;u++)p.push(t.getCharByIndex(u));t.importTitle=p,t.importData=i,t.importDataAoa=l},r.readAsArrayBuffer(e),!1},importFile2:function(e){var t=this;if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return this.$message.error("只能选择 excel 文件"),!1;if(e.size/1024/1024>20)return this.$message.error("大小不能超过 20MB"),!1;var r=new FileReader;return r.onload=function(e){var r=new Uint8Array(e.target.result),a=(0,s.ij)(r,{type:"array"}),n=a.SheetNames,o=a.Sheets[n[0]],l=s.P6.sheet_to_json(o,{header:1});o["!merges"]&&o["!merges"].forEach((function(e){for(var t=e.s.r;t<=e.e.r;t++)for(var r=e.s.c;r<=e.e.c;r++)l[t][r]=l[e.s.r][e.s.c]}));var i=[],c=0,p=[];l.forEach((function(e){e.length>c&&(c=e.length);for(var r={},a=0;a<e.length;a++)r[t.getCharByIndex(a)]=e[a];i.push(r)}));for(var u=0;u<c;u++)p.push(t.getCharByIndex(u));t.importTitle=p,t.importData=i,t.importDataAoa=l},r.readAsArrayBuffer(e),!1},importFile3:function(e){var t=this;if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return this.$message.error("只能选择 excel 文件"),!1;if(e.size/1024/1024>20)return this.$message.error("大小不能超过 20MB"),!1;var r=new FileReader;return r.onload=function(e){var r=new Uint8Array(e.target.result),a=(0,s.ij)(r,{type:"array"}),n=a.SheetNames,o=a.Sheets[n[0]],l=s.P6.sheet_to_json(o,{header:1}),i=[],c=0,p=[];l.forEach((function(e){e.length>c&&(c=e.length);for(var r={},a=0;a<e.length;a++)r[t.getCharByIndex(a)]=e[a];i.push(r)}));for(var u=0;u<c;u++)p.push(t.getCharByIndex(u));o["!merges"]&&o["!merges"].forEach((function(e){for(var r=e.s.r;r<=e.e.r;r++)for(var a=e.s.c;a<=e.e.c;a++){var n=t.getCharByIndex(a);i[r]["__colspan__"+n]=0,i[r]["__rowspan__"+n]=0}var s=t.getCharByIndex(e.s.c);i[e.s.r]["__colspan__"+s]=e.e.c-e.s.c+1,i[e.s.r]["__rowspan__"+s]=e.e.r-e.s.r+1})),t.importTitle=p,t.importData=i,t.importDataAoa=l},r.readAsArrayBuffer(e),!1},getCharByIndex:function(e){var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(e<t.length)return t[e];var r=parseInt(e/t.length),a=e%t.length;return t[r]+t[a]},spanMethod:function(e){var t=e.row,r=e.column;if(!r.label)return[1,1];var a=t["__rowspan__"+r.label],n=t["__colspan__"+r.label];return[null==a?1:a,null==n?1:n]}}},l=o,i=r(1001),c=(0,i.Z)(l,a,n,!1,null,null,null),p=c.exports},37557:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ele-body"},[t("excel-export"),t("excel-import")],1)},n=[],s=r(61661),o=r(59431),l={name:"ExtensionExcel",components:{ExcelExport:s["default"],ExcelImport:o["default"]}},i=l,c=r(1001),p=(0,c.Z)(i,a,n,!1,null,null,null),u=p.exports},82472:function(e,t,r){var a=r(19843);a("Uint8",(function(e){return function(t,r,a){return e(this,t,r,a)}}))}}]);