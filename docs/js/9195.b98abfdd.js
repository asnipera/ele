"use strict";(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[9195],{89195:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("el-card",{attrs:{shadow:"never",header:"导入 Excel"}},[t("div",{staticStyle:{display:"flex","margin-bottom":"12px"}},[t("el-upload",{staticClass:"ele-action",attrs:{action:"","show-file-list":!1,"before-upload":e.importFile,accept:".xls,.xlsx"}},[t("el-button",{staticClass:"hidden-xs-only",attrs:{type:"primary",size:"small"}},[e._v(" 导入 ")])],1),t("el-upload",{staticClass:"ele-action",attrs:{action:"","show-file-list":!1,"before-upload":e.importFile2,accept:".xls,.xlsx"}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("导入拆分合并")])],1),t("el-upload",{staticClass:"ele-action",attrs:{action:"","show-file-list":!1,"before-upload":e.importFile3,accept:".xls,.xlsx"}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("导入保持合并")])],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",border:!0,data:e.importData,"span-method":e.spanMethod}},[t("el-table-column",{attrs:{type:"index",width:"45",align:"center"}}),e._l(e.importTitle,(function(e,s){return t("el-table-column",{key:s,attrs:{prop:e,label:e,align:"center","show-overflow-tooltip":""}})}))],2),t("el-row",{attrs:{gutter:30}},[t("el-col",e._b({},"el-col",e.styleResponsive?{md:12}:{span:12},!1),[t("div",{staticStyle:{padding:"15px 0"}},[e._v("二维数组格式数据:")]),t("pre",{staticStyle:{"max-height":"300px",overflow:"auto"}},[e._v(e._s(JSON.stringify(e.importDataAoa,null,4)))])]),t("el-col",e._b({},"el-col",e.styleResponsive?{md:12}:{span:12},!1),[t("div",{staticStyle:{padding:"15px 0"}},[e._v("JSON格式数据:")]),t("pre",{staticStyle:{"max-height":"300px",overflow:"auto"}},[e._v(e._s(JSON.stringify(e.importData,null,4)))])])],1)],1)},a=[],l=(s(48675),s(37380),s(1118),s(84105)),o={data(){return{importData:[],importTitle:["A","B","C","D","E","F","G"],importDataAoa:[]}},computed:{styleResponsive(){return this.$store.state.theme.styleResponsive}},methods:{importFile(e){if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return this.$message.error("只能选择 excel 文件"),!1;if(e.size/1024/1024>20)return this.$message.error("大小不能超过 20MB"),!1;const t=new FileReader;return t.onload=e=>{const t=new Uint8Array(e.target.result),s=(0,l.ij)(t,{type:"array"}),r=s.SheetNames,a=s.Sheets[r[0]],o=l.P6.sheet_to_json(a,{header:1}),i=[];let n=0;const p=[];o.forEach((e=>{e.length>n&&(n=e.length);const t={};for(let s=0;s<e.length;s++)t[this.getCharByIndex(s)]=e[s];i.push(t)}));for(let l=0;l<n;l++)p.push(this.getCharByIndex(l));this.importTitle=p,this.importData=i,this.importDataAoa=o},t.readAsArrayBuffer(e),!1},importFile2(e){if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return this.$message.error("只能选择 excel 文件"),!1;if(e.size/1024/1024>20)return this.$message.error("大小不能超过 20MB"),!1;const t=new FileReader;return t.onload=e=>{const t=new Uint8Array(e.target.result),s=(0,l.ij)(t,{type:"array"}),r=s.SheetNames,a=s.Sheets[r[0]],o=l.P6.sheet_to_json(a,{header:1});a["!merges"]&&a["!merges"].forEach((e=>{for(let t=e.s.r;t<=e.e.r;t++)for(let s=e.s.c;s<=e.e.c;s++)o[t][s]=o[e.s.r][e.s.c]}));const i=[];let n=0;const p=[];o.forEach((e=>{e.length>n&&(n=e.length);const t={};for(let s=0;s<e.length;s++)t[this.getCharByIndex(s)]=e[s];i.push(t)}));for(let l=0;l<n;l++)p.push(this.getCharByIndex(l));this.importTitle=p,this.importData=i,this.importDataAoa=o},t.readAsArrayBuffer(e),!1},importFile3(e){if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return this.$message.error("只能选择 excel 文件"),!1;if(e.size/1024/1024>20)return this.$message.error("大小不能超过 20MB"),!1;const t=new FileReader;return t.onload=e=>{const t=new Uint8Array(e.target.result),s=(0,l.ij)(t,{type:"array"}),r=s.SheetNames,a=s.Sheets[r[0]],o=l.P6.sheet_to_json(a,{header:1}),i=[];let n=0;const p=[];o.forEach((e=>{e.length>n&&(n=e.length);const t={};for(let s=0;s<e.length;s++)t[this.getCharByIndex(s)]=e[s];i.push(t)}));for(let l=0;l<n;l++)p.push(this.getCharByIndex(l));a["!merges"]&&a["!merges"].forEach((e=>{for(let s=e.s.r;s<=e.e.r;s++)for(let t=e.s.c;t<=e.e.c;t++){const e=this.getCharByIndex(t);i[s]["__colspan__"+e]=0,i[s]["__rowspan__"+e]=0}const t=this.getCharByIndex(e.s.c);i[e.s.r]["__colspan__"+t]=e.e.c-e.s.c+1,i[e.s.r]["__rowspan__"+t]=e.e.r-e.s.r+1})),this.importTitle=p,this.importData=i,this.importDataAoa=o},t.readAsArrayBuffer(e),!1},getCharByIndex(e){const t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(e<t.length)return t[e];const s=parseInt(e/t.length),r=e%t.length;return t[s]+t[r]},spanMethod({row:e,column:t}){if(!t.label)return[1,1];const s=e["__rowspan__"+t.label],r=e["__colspan__"+t.label];return[null==s?1:s,null==r?1:r]}}},i=o,n=s(1001),p=(0,n.Z)(i,r,a,!1,null,null,null),c=p.exports}}]);