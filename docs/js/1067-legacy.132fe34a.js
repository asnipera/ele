"use strict";(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[1067],{91067:function(e,t,n){n.r(t),n.d(t,{default:function(){return u}});var i=function(){var e=this,t=e._self._c;return t("ele-modal",{attrs:{top:"5vh",width:"1100px",visible:e.visible,title:"卷内文件调整","custom-class":"demo-file-sort-dialog"},on:{"update:visible":e.updateVisible},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",[t("el-button",{on:{click:e.close}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)]},proxy:!0}])},[t("el-row",{attrs:{gutter:15}},[t("el-col",e._b({},"el-col",e.styleResponsive?{md:8}:{span:8},!1),[t("ele-pro-table",{ref:"docTable",staticClass:"demo-file-sort-table",attrs:{"sub-title":"案卷列表",datasource:e.documents,columns:e.columns1,"highlight-current-row":"",height:"400px",toolkit:[],"need-page":!1,current:e.current,"tool-style":{lineHeight:"28px"}},on:{"update:current":function(t){e.current=t},done:e.onDocTbDone}})],1),t("el-col",e._b({},"el-col",e.styleResponsive?{md:8}:{span:8},!1),[t("ele-pro-table",{ref:"fileTable",attrs:{loading:e.loading,"sub-title":"卷内列表",datasource:e.data1,columns:e.columns2,height:"400px",selection:e.selection1,"need-page":!1,toolkit:[]},on:{"update:selection":function(t){e.selection1=t}},scopedSlots:e._u([{key:"toolkit",fn:function(){return[t("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-top",size:"mini"},on:{click:e.moveUp}},[e._v(" 上移 ")]),t("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-bottom",size:"mini"},on:{click:e.moveDown}},[e._v(" 下移 ")]),t("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-top-right",size:"mini"},on:{click:e.moveOut}},[e._v(" 调出 ")])]},proxy:!0}])})],1),t("el-col",e._b({},"el-col",e.styleResponsive?{md:8}:{span:8},!1),[t("ele-pro-table",{attrs:{loading:e.loading,"sub-title":"未归档列表",datasource:e.data2,columns:e.columns2,height:"400px",selection:e.selection2,"need-page":!1,toolkit:[]},on:{"update:selection":function(t){e.selection2=t}},scopedSlots:e._u([{key:"toolkit",fn:function(){return[t("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-top-left",size:"mini"},on:{click:e.moveIn}},[e._v(" 调入 ")])]},proxy:!0}])})],1)],1)],1)},o=[],s=(n(57327),n(41539),n(21249),n(54747),n(21513)),r={props:{visible:Boolean,documents:{type:Array,required:!0}},data:function(){return{loading:!0,columns1:[{prop:"title",label:"案卷题名",width:110,showOverflowTooltip:!0},{prop:"piece_no",label:"案卷档号",showOverflowTooltip:!0}],columns2:[{columnKey:"selection",type:"selection",width:45,align:"center"},{prop:"title",label:"文件题名",width:110,showOverflowTooltip:!0},{prop:"archive_no",label:"文件档号",showOverflowTooltip:!0}],data:[],current:null,selection1:[],selection2:[]}},computed:{data1:function(){var e=this;return this.current?this.data.filter((function(t){return t.piece_no===e.current.piece_no})):[]},data2:function(){return this.data.filter((function(e){return!e.piece_no}))},styleResponsive:function(){return this.$store.state.theme.styleResponsive}},methods:{onDocTbDone:function(){this.documents.length&&this.$refs.docTable.setCurrentRow(this.documents[0])},query:function(){var e=this;this.loading=!0,(0,s.v)({pieceNoIn:this.documents.map((function(e){return e.piece_no}))}).then((function(t){e.loading=!1,e.data=t})).catch((function(t){e.loading=!1,e.$message.error(t.message)}))},moveUp:function(){var e=this;if(this.selection1.length){if(this.selection1.length>1)this.$message.error("只能选择一条数据");else if(0!==this.data1.indexOf(this.selection1[0])){var t=this.data.indexOf(this.selection1[0]),n=this.data[t-1];this.$set(this.data,t-1,this.selection1[0]),this.$set(this.data,t,n),this.$nextTick((function(){e.$refs.fileTable.toggleRowSelection(e.data[t-1],!0)}))}}else this.$message.error("请选择一条数据")},moveDown:function(){var e=this;if(this.selection1.length){if(this.selection1.length>1)this.$message.error("只能选择一条数据");else if(this.data1.indexOf(this.selection1[0])!==this.data1.length-1){var t=this.data.indexOf(this.selection1[0]),n=this.data[t+1];this.$set(this.data,t+1,this.selection1[0]),this.$set(this.data,t,n),this.$nextTick((function(){e.$refs.fileTable.toggleRowSelection(e.data[t+1],!0)}))}}else this.$message.error("请选择一条数据")},moveOut:function(){this.selection1.length?this.selection1.forEach((function(e){e.piece_no=""})):this.$message.error("请至少选择一条数据")},moveIn:function(){var e=this;this.current&&(this.selection2.length?this.selection2.forEach((function(t){t.piece_no=e.current.piece_no})):this.$message.error("请至少选择一条数据"))},save:function(){var e=this.data.map((function(e){return{archive_no:e.archive_no,piece_no:e.piece_no}}));console.log(e),this.updateVisible(!1)},close:function(){this.updateVisible(!1)},updateVisible:function(e){this.$emit("update:visible",e)}},watch:{visible:function(e){e?this.query():this.data=[]}}},a=r,l=n(1001),c=(0,l.Z)(a,i,o,!1,null,"b8860126",null),u=c.exports},21513:function(e,t,n){n.d(t,{Z:function(){return r},v:function(){return l}});var i=n(50124),o=n(48534),s=(n(41539),n(21703),n(84471));function r(e){return a.apply(this,arguments)}function a(){return a=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s.Z.get("https://cdn.eleadmin.com/20200610/document.json",{params:t});case 2:if(n=e.sent,0!==n.data.code){e.next=5;break}return e.abrupt("return",n.data.data);case 5:return e.abrupt("return",Promise.reject(new Error(n.data.message)));case 6:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}function l(e){return c.apply(this,arguments)}function c(){return c=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s.Z.get("https://cdn.eleadmin.com/20200610/archive.json",{params:t});case 2:if(n=e.sent,0!==n.data.code){e.next=5;break}return e.abrupt("return",n.data.data);case 5:return e.abrupt("return",Promise.reject(new Error(n.data.message)));case 6:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}}}]);