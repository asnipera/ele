(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[9431],{59431:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});r(38862);var a=function(){var e=this,t=e._self._c;return t("el-card",{attrs:{shadow:"never",header:"导入 Excel"}},[t("div",{staticStyle:{display:"flex","margin-bottom":"12px"}},[t("el-upload",{staticClass:"ele-action",attrs:{action:"","show-file-list":!1,"before-upload":e.importFile,accept:".xls,.xlsx"}},[t("el-button",{staticClass:"hidden-xs-only",attrs:{type:"primary",size:"small"}},[e._v(" 导入 ")])],1),t("el-upload",{staticClass:"ele-action",attrs:{action:"","show-file-list":!1,"before-upload":e.importFile2,accept:".xls,.xlsx"}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("导入拆分合并")])],1),t("el-upload",{staticClass:"ele-action",attrs:{action:"","show-file-list":!1,"before-upload":e.importFile3,accept:".xls,.xlsx"}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("导入保持合并")])],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{size:"mini",border:!0,data:e.importData,"span-method":e.spanMethod}},[t("el-table-column",{attrs:{type:"index",width:"45",align:"center"}}),e._l(e.importTitle,(function(e,r){return t("el-table-column",{key:r,attrs:{prop:e,label:e,align:"center","show-overflow-tooltip":""}})}))],2),t("el-row",{attrs:{gutter:30}},[t("el-col",e._b({},"el-col",e.styleResponsive?{md:12}:{span:12},!1),[t("div",{staticStyle:{padding:"15px 0"}},[e._v("二维数组格式数据:")]),t("pre",{staticStyle:{"max-height":"300px",overflow:"auto"}},[e._v(e._s(JSON.stringify(e.importDataAoa,null,4)))])]),t("el-col",e._b({},"el-col",e.styleResponsive?{md:12}:{span:12},!1),[t("div",{staticStyle:{padding:"15px 0"}},[e._v("JSON格式数据:")]),t("pre",{staticStyle:{"max-height":"300px",overflow:"auto"}},[e._v(e._s(JSON.stringify(e.importData,null,4)))])])],1)],1)},n=[],s=(r(26699),r(39575),r(41539),r(82472),r(48675),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(37380),r(1118),r(54747),r(84105)),i={data:function(){return{importData:[],importTitle:["A","B","C","D","E","F","G"],importDataAoa:[]}},computed:{styleResponsive:function(){return this.$store.state.theme.styleResponsive}},methods:{importFile:function(e){var t=this;if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return this.$message.error("只能选择 excel 文件"),!1;if(e.size/1024/1024>20)return this.$message.error("大小不能超过 20MB"),!1;var r=new FileReader;return r.onload=function(e){var r=new Uint8Array(e.target.result),a=(0,s.ij)(r,{type:"array"}),n=a.SheetNames,i=a.Sheets[n[0]],o=s.P6.sheet_to_json(i,{header:1}),l=[],p=0,c=[];o.forEach((function(e){e.length>p&&(p=e.length);for(var r={},a=0;a<e.length;a++)r[t.getCharByIndex(a)]=e[a];l.push(r)}));for(var u=0;u<p;u++)c.push(t.getCharByIndex(u));t.importTitle=c,t.importData=l,t.importDataAoa=o},r.readAsArrayBuffer(e),!1},importFile2:function(e){var t=this;if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return this.$message.error("只能选择 excel 文件"),!1;if(e.size/1024/1024>20)return this.$message.error("大小不能超过 20MB"),!1;var r=new FileReader;return r.onload=function(e){var r=new Uint8Array(e.target.result),a=(0,s.ij)(r,{type:"array"}),n=a.SheetNames,i=a.Sheets[n[0]],o=s.P6.sheet_to_json(i,{header:1});i["!merges"]&&i["!merges"].forEach((function(e){for(var t=e.s.r;t<=e.e.r;t++)for(var r=e.s.c;r<=e.e.c;r++)o[t][r]=o[e.s.r][e.s.c]}));var l=[],p=0,c=[];o.forEach((function(e){e.length>p&&(p=e.length);for(var r={},a=0;a<e.length;a++)r[t.getCharByIndex(a)]=e[a];l.push(r)}));for(var u=0;u<p;u++)c.push(t.getCharByIndex(u));t.importTitle=c,t.importData=l,t.importDataAoa=o},r.readAsArrayBuffer(e),!1},importFile3:function(e){var t=this;if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type))return this.$message.error("只能选择 excel 文件"),!1;if(e.size/1024/1024>20)return this.$message.error("大小不能超过 20MB"),!1;var r=new FileReader;return r.onload=function(e){var r=new Uint8Array(e.target.result),a=(0,s.ij)(r,{type:"array"}),n=a.SheetNames,i=a.Sheets[n[0]],o=s.P6.sheet_to_json(i,{header:1}),l=[],p=0,c=[];o.forEach((function(e){e.length>p&&(p=e.length);for(var r={},a=0;a<e.length;a++)r[t.getCharByIndex(a)]=e[a];l.push(r)}));for(var u=0;u<p;u++)c.push(t.getCharByIndex(u));i["!merges"]&&i["!merges"].forEach((function(e){for(var r=e.s.r;r<=e.e.r;r++)for(var a=e.s.c;a<=e.e.c;a++){var n=t.getCharByIndex(a);l[r]["__colspan__"+n]=0,l[r]["__rowspan__"+n]=0}var s=t.getCharByIndex(e.s.c);l[e.s.r]["__colspan__"+s]=e.e.c-e.s.c+1,l[e.s.r]["__rowspan__"+s]=e.e.r-e.s.r+1})),t.importTitle=c,t.importData=l,t.importDataAoa=o},r.readAsArrayBuffer(e),!1},getCharByIndex:function(e){var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(e<t.length)return t[e];var r=parseInt(e/t.length),a=e%t.length;return t[r]+t[a]},spanMethod:function(e){var t=e.row,r=e.column;if(!r.label)return[1,1];var a=t["__rowspan__"+r.label],n=t["__colspan__"+r.label];return[null==a?1:a,null==n?1:n]}}},o=i,l=r(1001),p=(0,l.Z)(o,a,n,!1,null,null,null),c=p.exports},82472:function(e,t,r){var a=r(19843);a("Uint8",(function(e){return function(t,r,a){return e(this,t,r,a)}}))}}]);